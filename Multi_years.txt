Sub Stocks_A()'create a loop through each sheet'in column I output tickerFor Each ws In Worksheets        ' Create a Variable to Hold File Name, Last Row, and Year        Dim WorksheetName As String        ' Determine the Last Row        LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row                WorksheetName = ws.Name        'Add a column for tickerws.Range("I1").EntireColumn.Insertws.Range("I1").Value = "Ticker"'Add a column for Yearly Changews.Range("J1").EntireColumn.Insertws.Range("J1").Value = "Yearly Change"'Add a column for Percent Changews.Range("K1").EntireColumn.Insertws.Range("K1").Value = "Percent Change"'add a column for total volumews.Range("L1").EntireColumn.Insertws.Range("L1").Value = "Total Stock Volume"'Set column O to display Greatest % Increase(row2),Decreased (row 2) and Total Volume (row 3)ws.Range("O2").Value = "Greatest % Increase"ws.Range("O3").Value = "Greatest % Decrease"ws.Range("O4").Value = "Greatest Total Volume"'Set column P to display Tickerws.Range("P1").EntireColumn.Insertws.Range("P1").Value = "Ticker"'Set column Q to display Valuews.Range("Q1").EntireColumn.Insertws.Range("Q1").Value = "Value"'Loop through column A  ' Set a variable for specifying the column of interest  Dim column As Integer  column = 1    Dim outputrow As Integer      outputrow = 2    Dim open_price As Double open_price = ws.Cells(2, 3).Value    Dim close_price As Double    close_price = 0Dim total_stock As Doubletotal_stock = 0      ' Loop through rows in the column  For i = 2 To LastRowDim ticker_name As String    ticker_name = ws.Cells(i, 1).Value       ' Searches for when the value of the next cell is different than that of the current cell    If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then          'Set the column I to output ticker from column A        ws.Range("I" & outputrow) = ticker_name        total_stock = total_stock + ws.Cells(i, 7).Value'Set close_price close_price = ws.Cells(i, 6).Value           Dim yearly_change As Double        yearly_change = close_price - open_price      Dim percent_change As Double       percent_change = (close_price - open_price) / open_price     'Set new open_price   open_price = ws.Cells(i + 1, 3).Value      'Print the yearly change to the output row    ws.Range("J" & outputrow) = yearly_change        'Print percent change to the output row        ws.Range("K" & outputrow) = percent_change       ws.Range("K" & outputrow).NumberFormat = "#0.00%"             'Print Total stock to the output row        ws.Range("L" & outputrow) = total_stock                 If ws.Range("J" & outputrow).Value < 0 Thenws.Range("J" & outputrow).Interior.ColorIndex = 3Elsews.Range("J" & outputrow).Interior.ColorIndex = 4End If             'Add 1 to the outputrow        outputrow = outputrow + 1        total_stock = 0            Else        total_stock = total_stock + ws.Cells(i, 7).Value            'Print Total stock to the output row        ws.Range("L" & outputrow) = total_stock            End IfNext i'Calculate the max increase, max decrease and maximum stock volume and display separately Dim max_increase As DoubleDim max_decrease As DoubleDim max_volume As DoubleDim ticker_cell As Rangemax_increase = Application.WorksheetFunction.Max(ws.Range("K2:K" & LastRow))ticker_row = WorksheetFunction.Match(WorksheetFunction.Max(ws.Range("K2:K" & LastRow)), ws.Range("K2:K" & LastRow), 0)ws.Range("Q2").NumberFormat = "#0.00%"ws.Range("Q2") = max_increasews.Range("P2") = ws.Cells(ticker_row + 1, 9)   max_decrease = Application.WorksheetFunction.Min(ws.Range("K2:K" & LastRow))ticker_row = WorksheetFunction.Match(WorksheetFunction.Min(ws.Range("K2:K" & LastRow)), ws.Range("K2:K" & LastRow), 0)ws.Range("Q3").NumberFormat = "#0.00%"ws.Range("Q3") = max_decreasews.Range("P3") = ws.Cells(ticker_row + 1, 9)max_volume = Application.WorksheetFunction.Max(ws.Range("L2:L" & LastRow))ticker_row = WorksheetFunction.Match(WorksheetFunction.Max(ws.Range("L2:L" & LastRow)), ws.Range("L2:L" & LastRow), 0)ws.Range("Q4") = max_volumews.Range("P4") = ws.Cells(ticker_row + 1, 9)Next ws End Sub